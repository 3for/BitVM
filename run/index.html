<h1>Open the Developer Console</h1>
<script type="module">
    import { compileSequence, Leaf } from '../transactions/transaction.js'
    import { challengeResponseSequence, justiceRoot } from '../transactions/reveal-sequence.js'
    import { merkleSequence } from '../transactions/merkle-sequence.js'
    import { bitvmSequence, LOG_TRACE_LEN } from '../transactions/bitvm.js'
    import { Player } from '../scripts/player.js'
    import { fetchUnspentOutputs } from '../libs/esplora.js'

    window.paul  = new Player('d898098e09898a0980989b980809809809f09809884324874302975287524398')
    window.vicky = new Player('a9bd8b8ade888ed12301b21318a3a73429232343587049870132987481723497')


    // Fetch the output
    const fundingAddress = 'tb1pe89ms4pj3djwwvw6es6dyc5x57v96nqkh6fs24dqwhnqqcumtckqsd8v8q'
    const outpoint = (await fetchUnspentOutputs( fundingAddress )).filter(utxo => utxo.value == 1_000_000)[0]

    if(!outpoint) throw `You have to charge the contract with 1'000'000 sats! \n ${fundingAddress}`

    const finalAddress = 'tb1pq7u2ujdvjzsy36d4xdt6yd2txv6wnj97aqf7ewvwnxn7ql5v8w3sg98j36'

    const sequence = bitvmSequence(vicky, paul)

    const txs = compileSequence(sequence, outpoint, finalAddress)

    const contractAddress = txs[0].address()
    console.log(contractAddress)
    console.log(txs)


    // Trace challenge
    for(let i = 0; i < LOG_TRACE_LEN; i++){
        await txs.shift().getLeaf(0).execute('deadbeefdeadbeefdeadbeefdeadbeefdeadbeef')
        await txs.shift().getLeaf(0).execute(1)
    }

    // Instruction commit
    await txs.shift().getLeaf(0).execute(42, 3, 42, 420, 43, 430, 44, 440)

    // Instruction challenge
    await txs.shift().getLeaf(0).execute()


    // You can either challenge the execution or the Merkle inclusion

    // // Instruction execution
    // await txs.shift().getLeaf(2).execute(42, 23, 19)


    // Merkle challenge
    for(let i = 0; i < 5; i++){
        await txs.shift().getLeaf(0).execute('deadbeefdeadbeefdeadbeefdeadbeefdeadbeef')
        await txs.shift().getLeaf(0).execute(1)
    }

    // Merkle challenge selection
    await txs.shift().getLeaf(3).execute(0b10001)

    // Merkle-triple execution
    await txs.shift().getLeaf(4).execute(
        'cea7db5e66bd5868387a438d8512a72cde5f973e',
        '79db24d391abb5c560e26454d29ff3ceb938681e',
        'ebd2c3f8b23391c56c7a5b1725d9466825626a58', 
        42,
    )

    // Justice transaction
    await txs.shift().getLeaf(7).execute(2, 3)

   
</script>